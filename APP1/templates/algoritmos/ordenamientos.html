{% extends 'algoritmos/index.html' %}
{% load static %}
{% block extra_css %}
<style>
    #data-grid {
        overflow-x: auto;
        padding: 20px;
    }
    .table {
        min-width: 600px;
        margin: 20px 0;
    }
    .pagination {
        margin-top: 20px;
        text-align: center;
    }
    .pagination button {
        margin: 0 5px;
        padding: 5px 10px;
    }
    .pagination span {
        margin: 0 10px;
    }
</style>
{% endblock %}

{% block content %}
<section class="container my-4">
    <h3>Algoritmos de Ordenamiento</h3>
    
    <div class="mb-4">
        <button class="btn btn-primary" onclick="showData('bubble')">Ordenamiento por Burbuja</button>
        <button class="btn btn-primary" onclick="showData('selection')">Ordenamiento por Selección</button>
        <button class="btn btn-primary" onclick="showData('insertion')">Ordenamiento por Inserción</button>
        <button class="btn btn-primary" onclick="showData('quick')">Ordenamiento Rápido</button>
        <button class="btn btn-primary" onclick="showData('merge')">Ordenamiento por Mezcla</button>
    </div><br/>

    <div id="data-grid" class="mt-4">
    </div>
</section>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
    const pageSize = 5;
    let currentPage = 1;
    let totalPages = 0;
    let data = [];

    function showData(algorithm) {
        const dataGrid = document.getElementById('data-grid');

        fetch(`/sorting/?algorithm=${algorithm}`)
            .then(response => response.json())
            .then(result => {
                data = result;
                totalPages = Math.ceil(data.length / pageSize);
                currentPage = 1;
                renderTable();
            })
            .catch(error => {
                console.error('Error al realizar la búsqueda:', error);
                dataGrid.innerHTML = '<p>Error al realizar la búsqueda. Intente nuevamente.</p>';
            });
    }

    function renderTable() {
        const dataGrid = document.getElementById('data-grid');
        const start = (currentPage - 1) * pageSize;
        const end = start + pageSize;
        const paginatedData = data.slice(start, end);

        const resultTable = `
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${paginatedData.map(item => `
                            <tr>
                                <td>${item.id}</td>
                                <td>${item.nombre}</td>
                                <td>${item.valor}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
            <div class="pagination">
                <button ${currentPage === 1 ? 'disabled' : ''} onclick="changePage(currentPage - 1)">Anterior</button>
                <span>Página ${currentPage} de ${totalPages}</span>
                <button ${currentPage === totalPages ? 'disabled' : ''} onclick="changePage(currentPage + 1)">Siguiente</button>
            </div>
        `;
        dataGrid.innerHTML = resultTable;
    }

    function changePage(page) {
        if (page < 1 || page > totalPages) return;
        currentPage = page;
        renderTable();
    }
</script>
{% endblock %}

